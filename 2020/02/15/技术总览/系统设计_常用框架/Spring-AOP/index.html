<!DOCTYPE html>





<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    save_scroll: false,
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    }
  };
</script>

  <meta name="description" content="AOP能做什么面向切面编程（Aspect Oriented Programing）。实际上是将一些通用的功能横向抽取出来：一方面，可减少系统的代码；另一方面，降低模块间的耦合度，比较好的维护和扩展。* 性能监控，在方法调用前后记录调用时间，方法执行太长或超时报警。 * 缓存代理，缓存某方法的返回值，下次执行该方法时，直接从缓存里获取。 * 软件破解，使用AOP修改软件的验证类的判断逻辑。 * 记录">
<meta name="keywords" content="技术总览">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring AOP">
<meta property="og:url" content="http://yoursite.com/2020/02/15/技术总览/系统设计_常用框架/Spring-AOP/index.html">
<meta property="og:site_name" content="凡星一点">
<meta property="og:description" content="AOP能做什么面向切面编程（Aspect Oriented Programing）。实际上是将一些通用的功能横向抽取出来：一方面，可减少系统的代码；另一方面，降低模块间的耦合度，比较好的维护和扩展。* 性能监控，在方法调用前后记录调用时间，方法执行太长或超时报警。 * 缓存代理，缓存某方法的返回值，下次执行该方法时，直接从缓存里获取。 * 软件破解，使用AOP修改软件的验证类的判断逻辑。 * 记录">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-02-15T06:14:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring AOP">
<meta name="twitter:description" content="AOP能做什么面向切面编程（Aspect Oriented Programing）。实际上是将一些通用的功能横向抽取出来：一方面，可减少系统的代码；另一方面，降低模块间的耦合度，比较好的维护和扩展。* 性能监控，在方法调用前后记录调用时间，方法执行太长或超时报警。 * 缓存代理，缓存某方法的返回值，下次执行该方法时，直接从缓存里获取。 * 软件破解，使用AOP修改软件的验证类的判断逻辑。 * 记录">
  <link rel="canonical" href="http://yoursite.com/2020/02/15/技术总览/系统设计_常用框架/Spring-AOP/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Spring AOP | 凡星一点</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  <div class="container sidebar-position-left">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">凡星一点</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-booklist">
      
    

    <a href="/booklist/" rel="section"><i class="menu-item-icon fa fa-fw fa-link"></i> <br>书单</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    
  <div class="popup search-popup">
  <div class="search-header">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <div class="search-input-wrapper">
      <input autocomplete="off" autocorrect="off" autocapitalize="none"
             placeholder="搜索..." spellcheck="false"
             type="text" id="search-input">
    </div>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>
  <div id="search-result"></div>
</div>


  </div>
</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content page-post-detail">
            

  <div id="posts" class="posts-expand">
    

  <article class="post" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/15/技术总览/系统设计_常用框架/Spring-AOP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ugia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="凡星一点">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Spring AOP

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-02-15 11:40:40 / 修改时间：14:14:35" itemprop="dateCreated datePublished" datetime="2020-02-15T11:40:40+08:00">2020-02-15</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/技术总览/" itemprop="url" rel="index"><span itemprop="name">技术总览</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/技术总览/系统设计/" itemprop="url" rel="index"><span itemprop="name">系统设计</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/技术总览/系统设计/常用框架/" itemprop="url" rel="index"><span itemprop="name">常用框架</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h4 id="AOP能做什么"><a href="#AOP能做什么" class="headerlink" title="AOP能做什么"></a>AOP能做什么</h4><p>面向切面编程（Aspect Oriented Programing）。实际上是将一些通用的功能横向抽取出来：一方面，可减少系统的代码；另一方面，降低模块间的耦合度，比较好的维护和扩展。</p><pre><code>* 性能监控，在方法调用前后记录调用时间，方法执行太长或超时报警。
* 缓存代理，缓存某方法的返回值，下次执行该方法时，直接从缓存里获取。
* 软件破解，使用AOP修改软件的验证类的判断逻辑。
* 记录日志，在方法执行前后记录系统日志。
* 工作流系统，工作流系统需要将业务代码和流程引擎代码混合在一起执行，那么我们可以使用AOP将其分离，并动态挂接业务。
* 权限验证，方法执行前验证是否有权限执行当前方法，没有则抛出没有权限执行异常，由业务代码捕捉。</code></pre><a id="more"></a>
<h4 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 公共接口</span><br><span class="line">interface DO&#123;</span><br><span class="line">	public abstract void doSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 真实对象类</span><br><span class="line">class RealObject implements DO&#123;</span><br><span class="line">	public void doSomething()&#123;</span><br><span class="line">		System.out.print(&quot;hello,我是真实对象...&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 代理对象类</span><br><span class="line">class ProxyObject implements DO&#123;</span><br><span class="line">	private RealObject realObj = null;//真实对象的引用</span><br><span class="line">	</span><br><span class="line">	public ProxyObject()&#123;</span><br><span class="line">		realObj = new RealObject();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	public void doSomething() &#123;</span><br><span class="line">		//1、做一些权限控制之类的</span><br><span class="line">		if(realObj==null)&#123;//2、延迟加载</span><br><span class="line">			realObj = new RealObject();</span><br><span class="line">		&#125;</span><br><span class="line">		realObj.doSomething();</span><br><span class="line">		//3、再做一些事情	</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 测试代码</span><br><span class="line">ProxyObject proxyObj = new ProxyObject();</span><br><span class="line">proxyObj.doSomething();</span><br></pre></td></tr></table></figure>

<h4 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h4><p>github参考:<a href="https://github.com/MatrixSeven/JavaAOP" target="_blank" rel="noopener">https://github.com/MatrixSeven/JavaAOP</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 公共接口</span><br><span class="line">interface DO&#123;</span><br><span class="line">	public abstract void doSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 真实对象类</span><br><span class="line">class RealObject implements DO&#123;</span><br><span class="line">	public void doSomething()&#123;</span><br><span class="line">		System.out.print(&quot;hello,我是真实对象...&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 实现java提供的java.lang.reflect.InvocationHandler接口</span><br><span class="line">public class MyInvocationHandler implements InvocationHandler&#123;</span><br><span class="line">	//真实对象引用</span><br><span class="line">	private Object realObj=null;	</span><br><span class="line">	public MyInvocationHandler(Object realObj)&#123;</span><br><span class="line">		this.realObj = realObj;</span><br><span class="line">	&#125;</span><br><span class="line">	@Override</span><br><span class="line">	public Object invoke(Object proxy, Method method, Object[] args)</span><br><span class="line">throws Throwable &#123;</span><br><span class="line">		//。。。在真实对象执行方法前做一些处理</span><br><span class="line">		method.invoke(realObj, args);</span><br><span class="line">		//。。在真实对象执行方法之后做些处理</span><br><span class="line">		return null;</span><br><span class="line">	&#125;</span><br><span class="line">	//获取真实对象的代理对象</span><br><span class="line">	public Object getProxy() &#123;  </span><br><span class="line">    	return Proxy.newProxyInstance(Thread.currentThread().</span><br><span class="line">getContextClassLoader(),realObj.getClass().getInterfaces(), this);  </span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 测试</span><br><span class="line">//真实对象</span><br><span class="line">RealObject realObj = new RealObject();</span><br><span class="line">//调用处理器</span><br><span class="line">MyInvocationHandler handler = new MyInvocationHandler(realObj);</span><br><span class="line">//生成代理对象</span><br><span class="line">Do proxyObj = (Do)handler.getProxy();</span><br><span class="line">//代理执行方法</span><br><span class="line">proxyObj.doSomething();</span><br></pre></td></tr></table></figure>

<h4 id="Spring-AOP"><a href="#Spring-AOP" class="headerlink" title="Spring AOP"></a>Spring AOP</h4><p>原理</p>
<pre><code>* JDK 动态代理
* Cglib 动态代理</code></pre><p>概念</p>
<table>
<thead>
<tr>
<th>术语</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Joinpoint(连接点)</td>
<td>所谓连接点是指那些被拦截到的点。在Spring中,这些点指的是方法,因为Spring只支持方法类型的连接点。</td>
</tr>
<tr>
<td>Pointcut(切入点)</td>
<td>所谓切入点是指我们要对哪些Joinpoint进行拦截的定义。</td>
</tr>
<tr>
<td>Advice(通知/增强)</td>
<td>所谓通知是指拦截到Joinpoint之后所要做的事情就是通知。通知分为前置通知,后置通知,异常通知,最终通知,环绕通知(切面要完成的功能)</td>
</tr>
<tr>
<td>Introduction(引介)</td>
<td>引介是一种特殊的通知在不修改类代码的前提下, Introduction可以在运行期为类动态地添加一些方法或Field</td>
</tr>
<tr>
<td>Target(目标对象)</td>
<td>代理的目标对象</td>
</tr>
<tr>
<td>Weaving(织入)</td>
<td>指把增强应用到目标对象来创建新的代理对象的过程。 有三种织入方式： Spring采用动态代理织入，而AspectJ采用编译期织入和类装载期织入</td>
</tr>
<tr>
<td>Proxy（代理)</td>
<td>一个类被AOP织入增强后，就产生一个结果代理类</td>
</tr>
<tr>
<td>Aspect(切面)</td>
<td>是切入点和通知（/引介）的结合</td>
</tr>
</tbody></table>
<p>Spring的通知</p>
<pre><code>* @Before 前置：方法执行前切入。
* @AfterReturning 后置正常：方法正常执行后切入。
* @AfterThrowing 异常：抛出异常后切入。
* @After 后置：方法无论成功与否，退出后切入。
* @Around 环绕：在方法执行前执行后切入。</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// Spring配置文件</span><br><span class="line">&lt;beans </span><br><span class="line">//省略</span><br><span class="line">	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; </span><br><span class="line">	xsi:schemaLocation=&quot;</span><br><span class="line">//省略</span><br><span class="line">    http://www.springframework.org/schema/aop </span><br><span class="line">    http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;</span><br><span class="line">	&lt;aop:aspectj-autoproxy/&gt;   &lt;!-- aspect注解生效--&gt;</span><br><span class="line">	&lt;!-- &lt;aop:aspectj-autoproxy proxy-target-class=&quot;true&quot; /&gt; --&gt;</span><br><span class="line">&lt;/beans&gt;</span><br><span class="line">//注：&lt;aop:aspectj-autoproxy/&gt;有一个默认属性proxy-target-class，默认为false,表示使用JDK动态代理实现织入。</span><br><span class="line">//若proxy-target-class=&quot;true&quot;表示使用CGLib技术织入增强。</span><br><span class="line">//当然我们知道JDK动态代理是基于接口的，如果目标类不存在接口，Spring将自动使用CGLib实现。</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Spring AOP --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;spring-aop&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;4.3.1.RELEASE&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt; </span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;4.3.1.RELEASE&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;1.8.9&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;org.aspectj&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;1.8.9&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;asm&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;asm&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;3.3.1&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;cglib&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;cglib&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;3.2.4&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;cglib&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;cglib-nodep&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;3.2.4&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;aopalliance&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;aopalliance&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;1.0&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br><span class="line">		&lt;dependency&gt;</span><br><span class="line">		    &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;</span><br><span class="line">		    &lt;artifactId&gt;gson&lt;/artifactId&gt;</span><br><span class="line">		    &lt;version&gt;2.7&lt;/version&gt;</span><br><span class="line">		&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@Aspect</span><br><span class="line">public class LogAspect &#123;</span><br><span class="line">	</span><br><span class="line">	@Pointcut(&quot;execution(* com.danlu.aoptest.service.*.*(..)) &quot;)</span><br><span class="line">	private void logMethod()&#123;&#125;</span><br><span class="line">	</span><br><span class="line">	@Around(&quot;logMethod()&quot;)</span><br><span class="line">	public Object logAround(ProceedingJoinPoint point)&#123;</span><br><span class="line">		String methodName = null;	    //方法名</span><br><span class="line">		Object[] params = null;		//入參</span><br><span class="line">		Object returnValue = null;	//返回值</span><br><span class="line">		long execTime = 0;			//执行时间</span><br><span class="line">		try &#123;</span><br><span class="line">			methodName = &quot;[&quot; + point.getSignature().getDeclaringTypeName() +  &quot;.&quot; + point.getSignature().getName() + &quot;]&quot;;</span><br><span class="line">			System.out.println(&quot;目标方法为：&quot; + methodName);</span><br><span class="line">			params = point.getArgs();</span><br><span class="line">			Gson gson = new Gson();</span><br><span class="line">			System.out.println(&quot;参数为:&quot; + gson.toJson(params));</span><br><span class="line">			long startTime = System.currentTimeMillis();</span><br><span class="line">			returnValue = point.proceed(params);</span><br><span class="line">		    System.out.println(&quot;返回值为：&quot; + gson.toJson(returnValue));</span><br><span class="line">		    execTime = System.currentTimeMillis()-startTime;</span><br><span class="line">			System.out.println(&quot;执行时间为：&quot; + execTime + &quot;ms&quot;);</span><br><span class="line">		&#125; catch (Throwable e) &#123;</span><br><span class="line">			System.out.println(methodName + &quot;调用失败，抛出异常：&quot;+ e);</span><br><span class="line">		&#125;</span><br><span class="line">		return returnValue;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><figcaption><span>控制层演示实例</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">public class AOPTestController &#123;</span><br><span class="line">	</span><br><span class="line">	@Resource</span><br><span class="line">	private AopTestService aopTestService;</span><br><span class="line">	</span><br><span class="line">	@ResponseBody</span><br><span class="line">	@RequestMapping(&quot;getPersonInfo&quot;)</span><br><span class="line">	public Map&lt;String,Object&gt; getPersonInfo(int age)&#123;</span><br><span class="line">		Map&lt;String,Object&gt; result = new HashMap&lt;String,Object&gt;();</span><br><span class="line">		Person p0 = new Person();</span><br><span class="line">		p0.setName(&quot;小强&quot;);</span><br><span class="line">		p0.setSex(&quot;男&quot;);</span><br><span class="line">		p0.setAge(age);</span><br><span class="line">		</span><br><span class="line">		try &#123;</span><br><span class="line">			long startTime = System.currentTimeMillis();</span><br><span class="line">			Person p = this.aopTestService.getPersonInfo(&quot;小强&quot;,&quot;男&quot;,age,p0);</span><br><span class="line">			System.out.println(&quot;controller调用目标方法的执行时间为：&quot; + (System.currentTimeMillis()-startTime) + &quot;ms&quot;);</span><br><span class="line">			result.put(&quot;success&quot;, true);</span><br><span class="line">			result.put(&quot;p&quot;, p);</span><br><span class="line">		&#125; catch (Exception e) &#123;</span><br><span class="line">		&#125;</span><br><span class="line">		return result;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 业务层演示实例</span><br><span class="line">@Service</span><br><span class="line">public class AopTestServiceImpl implements AopTestService&#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public Person getPersonInfo(String name,String sex,int age,Person p0) throws Exception &#123;</span><br><span class="line">		if(age &lt; 1)&#123;</span><br><span class="line">			throw new IllegalArgumentException();</span><br><span class="line">		&#125;</span><br><span class="line">		Person p = new Person();</span><br><span class="line">		p.setName(&quot;小强&quot;);</span><br><span class="line">		p.setSex(&quot;男&quot;);</span><br><span class="line">		p.setAge(age);</span><br><span class="line">		return p;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">访问http://localhost:8080/aopTest/getPersonInfo.do?age=1</span><br><span class="line"></span><br><span class="line">目标方法为：[com.danlu.aoptest.serviceImpl.AopTestServiceImpl.getPersonInfo]</span><br><span class="line">参数为:[&quot;小强&quot;,&quot;男&quot;,1,&#123;&quot;name&quot;:&quot;小强&quot;,&quot;age&quot;:1,&quot;sex&quot;:&quot;男&quot;&#125;]</span><br><span class="line">返回值为：&#123;&quot;name&quot;:&quot;小强&quot;,&quot;age&quot;:1,&quot;sex&quot;:&quot;男&quot;&#125;</span><br><span class="line">执行时间：15ms</span><br><span class="line">controller调用目标方法的执行时间为：64ms</span><br><span class="line"></span><br><span class="line">访问http://localhost:8080/aopTest/getPersonInfo.do?age=0</span><br><span class="line"></span><br><span class="line">目标方法为：[com.danlu.aoptest.serviceImpl.AopTestServiceImpl.getPersonInfo]</span><br><span class="line">参数为:[&quot;小强&quot;,&quot;男&quot;,0,&#123;&quot;name&quot;:&quot;小强&quot;,&quot;age&quot;:0,&quot;sex&quot;:&quot;男&quot;&#125;]</span><br><span class="line">[com.danlu.aoptest.serviceImpl.AopTestServiceImpl.getPersonInfo]调用失败，抛出异常：java.lang.IllegalArgumentException</span><br><span class="line">controller调用目标方法的执行时间为：2ms</span><br></pre></td></tr></table></figure>

<p>动态代理、CGLib等形式的AOP实现，本质上还是代理，无论是基于接口的JDK动态代理，还是基于类的CGLib,都要为目标类生成代理类，这是否要考虑类膨胀的问题，是否有必要加大JVM方法区大小，这都是需要实践和测试的。</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/技术总览/" rel="tag"># 技术总览</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/02/11/技术总览/系统设计_常用框架/Spring-IOC/" rel="next" title="Spring IOC">
                  <i class="fa fa-chevron-left"></i> Spring IOC
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/02/15/技术总览/系统设计_常用框架/Spring-事务/" rel="prev" title="Spring 事务">
                  Spring 事务 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ugia</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">222</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>




        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#AOP能做什么"><span class="nav-number">1.</span> <span class="nav-text">AOP能做什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#静态代理"><span class="nav-number">2.</span> <span class="nav-text">静态代理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态代理"><span class="nav-number">3.</span> <span class="nav-text">动态代理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Spring-AOP"><span class="nav-number">4.</span> <span class="nav-text">Spring AOP</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ugia</span>
</div>
<!--
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.3.0</div>
-->

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>

    

  </div>

  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

<script src="/js/utils.js?v=7.3.0"></script><script src="/js/motion.js?v=7.3.0"></script>

<script src="/js/schemes/pisces.js?v=7.3.0"></script>



<script src="/js/next-boot.js?v=7.3.0"></script>




  















  <script src="/js/local-search.js?v=7.3.0"></script>














  

  

  


  
  <script src="/js/scrollspy.js?v=7.3.0"></script><script src="/js/post-details.js?v=7.3.0"></script>


</body>
</html>
